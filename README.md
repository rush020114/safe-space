# ğŸ›¡ï¸ SafeSpace - ì»¤ë®¤ë‹ˆí‹° ë³´í˜¸ ì‹œìŠ¤í…œ

<div align="center">

![Project Status](https://img.shields.io/badge/status-completed-success)
![Java](https://img.shields.io/badge/Java-17-007396?logo=java)
![Spring Boot](https://img.shields.io/badge/Spring_Boot-3.4-6DB33F?logo=spring-boot)
![Redis](https://img.shields.io/badge/Redis-DC382D?logo=redis&logoColor=white)
![MariaDB](https://img.shields.io/badge/MariaDB-003545?logo=mariadb&logoColor=white)

**ìš•ì„¤ í•„í„°ë§ê³¼ ë‹¨ê³„ì  ì œì¬ë¥¼ í†µí•œ ê±´ê°•í•œ ì»¤ë®¤ë‹ˆí‹° í™˜ê²½ êµ¬ì¶•**

</div>

---

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

ì˜¨ë¼ì¸ ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ë°œìƒí•˜ëŠ” ìš•ì„¤ê³¼ ë¹„ë°©ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ê³ , ë‹¨ê³„ì  ì œì¬ë¥¼ í†µí•´ ê±´ê°•í•œ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ í™˜ê²½ì„ ë§Œë“œëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### ğŸ’­ í”„ë¡œì íŠ¸ ë™ê¸°

> "ì˜ˆì „ì—ëŠ” ì˜¨ë¼ì¸ ì»¤ë®¤ë‹ˆí‹°ë‚˜ ê²Œì„ì—ì„œ ê°ì •ì ìœ¼ë¡œ ë°˜ì‘í•˜ëŠ” ì¼ì´ ë§ì•˜ìŠµë‹ˆë‹¤.  
> ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ê·¸ëŸ° í–‰ë™ì´ ëˆ„êµ°ê°€ì—ê²Œ ìƒì²˜ê°€ ë  ìˆ˜ ìˆë‹¤ëŠ” ê±¸ ê¹¨ë‹«ê²Œ ë˜ì—ˆê³ ,  
> ì§€ê¸ˆì€ ë” ê±´ê°•í•œ ë°©í–¥ìœ¼ë¡œ ë‚˜ì•„ê°€ê³ ì ë…¸ë ¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.  
> ì´ í”„ë¡œì íŠ¸ëŠ” ê·¸ëŸ° ê³ ë¯¼ì˜ ì—°ì¥ì„ ì—ì„œ, **ê¸°ìˆ ì„ í†µí•´ ë” ë‚˜ì€ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ í™˜ê²½**ì„ ë§Œë“¤ê³  ì‹¶ë‹¤ëŠ” ìƒê°ìœ¼ë¡œ ì‹œì‘í–ˆìŠµë‹ˆë‹¤."

---

## ğŸ¯ í•µì‹¬ ê¸°ëŠ¥

### 1ï¸âƒ£ ìš•ì„¤ ìë™ í•„í„°ë§
- í•œêµ­ì–´/ì˜ì–´ ìš•ì„¤ ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ì‹¤ì‹œê°„ ê°ì§€
- ì •ê·œí‘œí˜„ì‹ì„ í™œìš©í•œ ê³µë°± ë³€í˜• ì²˜ë¦¬ ("ë°” ë³´", "lo ser" ë“±)
- ê²Œì‹œê¸€/ëŒ“ê¸€ ì‘ì„± ì‹œ ìë™ ê²€ì¦

### 2ï¸âƒ£ ìë™ ì‹ ê³  ì‹œìŠ¤í…œ
- ìš•ì„¤ ê°ì§€ ì‹œ ì‹ ê³  ê°ì²´ ìë™ ìƒì„± ë° DB ì €ì¥
- ì¤‘ë³µ ì‹ ê³  ë°©ì§€ ë¡œì§
- ì‹ ê³  ëŒ€ìƒ êµ¬ë¶„ (ê²Œì‹œê¸€/ëŒ“ê¸€)

### 3ï¸âƒ£ SSE ì‹¤ì‹œê°„ ì•Œë¦¼
- ì‹ ê³  ë°œìƒ ì‹œ ê´€ë¦¬ìì—ê²Œ ì‹¤ì‹œê°„ ì•Œë¦¼
- EventSource ê¸°ë°˜ ë‹¨ë°©í–¥ í†µì‹ 
- JWT ì¸ì¦ê³¼ SSE í†µí•© (URL íŒŒë¼ë¯¸í„° ë°©ì‹)

### 4ï¸âƒ£ ë‹¨ê³„ì  ì œì¬ ì‹œìŠ¤í…œ
- **3íšŒ ê²½ê³ **: 1ë¶„ ì •ì§€
- **6íšŒ ê²½ê³ **: 3ë¶„ ì •ì§€  
- **9íšŒ ê²½ê³ **: ì˜êµ¬ ì •ì§€
- Redis ê¸°ë°˜ ì‹¤ì‹œê°„ ì œì¬ ìƒíƒœ ê´€ë¦¬

### 5ï¸âƒ£ Redis ìºì‹± ìµœì í™”
- ì œì¬ ì •ë³´ë¥¼ Redis Hash êµ¬ì¡°ë¡œ ì €ì¥
- ë§¤ ìš”ì²­ë§ˆë‹¤ DB ì¡°íšŒ ì—†ì´ Redisì—ì„œ ë¹ ë¥´ê²Œ í™•ì¸
- ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ í†µí•œ DB-Redis ë™ê¸°í™”

### 6ï¸âƒ£ JWT ì¸ì¦ & ì œì¬ ì—°ë™
- Spring Security + JWT ê¸°ë°˜ ì¸ì¦
- ë¡œê·¸ì¸ ì‹œ ì œì¬ ìƒíƒœ í™•ì¸
- ì œì¬ ì¤‘ì¸ ì‚¬ìš©ì ì¦‰ì‹œ ì°¨ë‹¨

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Backend
![Spring Boot](https://img.shields.io/badge/Spring_Boot-3.4.11-6DB33F?style=flat-square&logo=spring-boot&logoColor=white)
![Spring Security](https://img.shields.io/badge/Spring_Security-6DB33F?style=flat-square&logo=spring-security&logoColor=white)
![JWT](https://img.shields.io/badge/JWT-000000?style=flat-square&logo=json-web-tokens&logoColor=white)
![MyBatis](https://img.shields.io/badge/MyBatis-000000?style=flat-square&logo=mybatis&logoColor=white)

### Database & Cache
![MariaDB](https://img.shields.io/badge/MariaDB-003545?style=flat-square&logo=mariadb&logoColor=white)
![Redis](https://img.shields.io/badge/Redis-DC382D?style=flat-square&logo=redis&logoColor=white)

### Tools
![Gradle](https://img.shields.io/badge/Gradle-02303A?style=flat-square&logo=gradle&logoColor=white)
![Lombok](https://img.shields.io/badge/Lombok-BC4521?style=flat-square)

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚â”€â”€â”€â”€â”€>â”‚  Spring Boot     â”‚â”€â”€â”€â”€â”€>â”‚   MariaDB   â”‚
â”‚  (ê²Œì‹œê¸€    â”‚      â”‚  + Security      â”‚      â”‚ (ê²Œì‹œê¸€/    â”‚
â”‚   ì‘ì„±)     â”‚      â”‚  + JWT           â”‚      â”‚  íšŒì›/ì œì¬) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                        â†‘
                              â”‚                        â”‚
                              â†“                        â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
                     â”‚ ProfanityFilter â”‚              â”‚
                     â”‚  (ìš•ì„¤ ê°ì§€)    â”‚              â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
                              â”‚                        â”‚
                              â†“                        â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
                     â”‚  ReportService  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚   (ì‹ ê³  ì²˜ë¦¬)   â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â†“                   â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ SseEmitterServiceâ”‚  â”‚  RedisService   â”‚
           â”‚  (ì‹¤ì‹œê°„ ì•Œë¦¼)   â”‚  â”‚ (ì œì¬ ìºì‹±)     â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                   â”‚
                    â†“                   â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ â”‚  â”‚     Redis       â”‚
           â”‚   (SSE êµ¬ë…)    â”‚  â”‚ (Hash êµ¬ì¡°)     â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¡ ì£¼ìš” API ëª…ì„¸

<details>
<summary><b>ğŸ” ì¸ì¦ API</b></summary>

### ë¡œê·¸ì¸
```http
POST /member/login

Request Body:
{
  "memEmail": "user@example.com",
  "memPw": "password123"
}

Response: 200 OK
Headers:
  Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...

ì œì¬ ì¤‘ì¸ ê²½ìš°:
Response: 403 Forbidden
{
  "error": "ê³„ì •ì´ ì •ì§€ë˜ì—ˆìŠµë‹ˆë‹¤",
  "reason": "ì‹ ê³  3íšŒ ëˆ„ì ìœ¼ë¡œ 2025-11-14 15:30:00ê¹Œì§€ ì •ì§€"
}
```

</details>

<details>
<summary><b>ğŸ“ ê²Œì‹œê¸€/ëŒ“ê¸€ API</b></summary>

### ê²Œì‹œê¸€ ì‘ì„± (ìš•ì„¤ í•„í„°ë§ ì ìš©)
```http
POST /posts

Request Body:
{
  "postTitle": "ì œëª©",
  "postContent": "ë‚´ìš©"
}

ìš•ì„¤ í¬í•¨ ì‹œ:
Response: 400 Bad Request
{
  "error": "ìš•ì„¤ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤"
}

ì •ìƒ ì‘ì„± ì‹œ:
Response: 201 Created
â†’ ìš•ì„¤ ê°ì§€ ì‹œ ìë™ ì‹ ê³  ìƒì„±
â†’ SSEë¥¼ í†µí•´ ê´€ë¦¬ìì—ê²Œ ì‹¤ì‹œê°„ ì•Œë¦¼ ì „ì†¡
```

</details>

<details>
<summary><b>ğŸš¨ ì‹ ê³  API</b></summary>

### ê´€ë¦¬ì ì‹ ê³  ëª©ë¡ ì¡°íšŒ
```http
GET /admin/reports?targetType=POST

Response: 200 OK
[
  {
    "reportId": 1,
    "reportReason": "ìš•ì„¤ ì‚¬ìš©",
    "reportStatus": "PENDING",
    "targetType": "POST",
    "postDTO": {
      "postId": 5,
      "postContent": "ìš•ì„¤ì´ í¬í•¨ëœ ë‚´ìš©",
      "memId": 10
    },
    "reportDate": "2025-11-14T10:30:00"
  }
]
```

### ì‹ ê³  ì²˜ë¦¬ (ìŠ¹ì¸/ê±°ì ˆ)
```http
POST /admin/reports/handle

Request Body:
{
  "reportId": 1,
  "reportStatus": "APPROVED",
  "targetType": "POST"
}

Response: 200 OK
â†’ ì‹ ê³  ìŠ¹ì¸ ì‹œ ìë™ìœ¼ë¡œ:
  1. ê²Œì‹œê¸€/ëŒ“ê¸€ í•„í„°ë§ (ë¸”ë¼ì¸ë“œ ì²˜ë¦¬)
  2. íšŒì› ê²½ê³  íšŸìˆ˜ ì¦ê°€
  3. ê²½ê³  íšŸìˆ˜ì— ë”°ë¼ ì œì¬ ì ìš© (3íšŒ, 6íšŒ, 9íšŒ)
  4. Redisì— ì œì¬ ìƒíƒœ ì¦‰ì‹œ ë°˜ì˜
  5. Sanction í…Œì´ë¸”ì— ì œì¬ ê¸°ë¡ ì €ì¥
```

</details>

<details>
<summary><b>ğŸ”” SSE ì‹¤ì‹œê°„ ì•Œë¦¼ API</b></summary>

### ê´€ë¦¬ì SSE ì—°ê²°
```http
GET /admin/reports/stream?token=Bearer%20eyJhbGciOiJIUzI1NiJ9...

Response: 200 OK
Content-Type: text/event-stream

ì—°ê²° ì„±ê³µ ì´ë²¤íŠ¸:
event: connect
data: SSE ì—°ê²° ì„±ê³µ

ì‹ ê³  ë°œìƒ ì´ë²¤íŠ¸:
event: newReport
data: {
  "reportId": 5,
  "reportReason": "ìš•ì„¤ ì‚¬ìš©",
  "targetType": "POST",
  "reportDate": "2025-11-14T15:00:00"
}
```

**ğŸ’¡ ê¸°ìˆ  ì„ íƒ ì´ìœ **
- WebSocket ëŒ€ì‹  SSEë¥¼ ì„ íƒí•œ ì´ìœ :
  - ê´€ë¦¬ìë§Œ ë‹¨ë°©í–¥ ì•Œë¦¼ì„ ë°›ìœ¼ë©´ ë˜ëŠ” êµ¬ì¡°
  - HTTP ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„ì´ ê°„ë‹¨
  - ìë™ ì¬ì—°ê²° ê¸°ëŠ¥ ë‚´ì¥

**ğŸ” ë³´ì•ˆ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…**
- ë¬¸ì œ: SSEëŠ” Headerì— í† í°ì„ ë‹´ì„ ìˆ˜ ì—†ì–´ Spring Security ì¸ì¦ ì‹¤íŒ¨
- í•´ê²°: 
  1. URL íŒŒë¼ë¯¸í„°ë¡œ í† í° ì „ë‹¬
  2. `JwtConfirmFilter`ì—ì„œ URL íŒŒë¼ë¯¸í„° í† í° ì¶”ì¶œ ë¡œì§ ì¶”ê°€
  3. `@PreAuthorize("hasRole('ADMIN')")`ë¡œ ê¶Œí•œ ê²€ì¦

</details>

---

## ğŸ’¡ í•µì‹¬ êµ¬í˜„ ì½”ë“œ

<details>
<summary><b>1ï¸âƒ£ ìš•ì„¤ í•„í„°ë§ êµ¬í˜„</b></summary>

### ProfanityFilter.java
```java
@Slf4j
@Component
public class ProfanityFilter {
  // ìš•ì„¤ ë‹¨ì–´ ë¦¬ìŠ¤íŠ¸ (í•œêµ­ì–´ + ì˜ì–´)
  private static final List<String> PROFANITY_LIST = Arrays.asList(
    "ë°”ë³´", "ë©ì²­", "loser", "idiot" // ...
  );

  private final Pattern profanityPattern;

  public ProfanityFilter() {
    String regex = String.join("|", PROFANITY_LIST);
    this.profanityPattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);
  }

  // ìš•ì„¤ ì •ê·œí™” (ê³µë°± ì œê±°, ì†Œë¬¸ì ë³€í™˜)
  public String preprocess(String text) {
    return text
      .replaceAll("\\s+", "")      // "ë°” ë³´" â†’ "ë°”ë³´"
      .toLowerCase();               // "LOSER" â†’ "loser"
  }

  // ìš•ì„¤ í¬í•¨ ì—¬ë¶€ í™•ì¸
  public boolean containsProfanity(String input) {
    String cleaned = preprocess(input);
    return profanityPattern.matcher(cleaned).find();
  }
}
```

**êµ¬í˜„ íŠ¹ì§•**
- âœ… "ë°” ë³´", "ë°”     ë³´" ê°™ì€ ê³µë°± ë³€í˜• ì²˜ë¦¬
- âœ… "lo ser", "LOSER" ê°™ì€ ëŒ€ì†Œë¬¸ì ë³€í˜• ì²˜ë¦¬
- âŒ "ë°”1ë³´", "ë°”ì•„ì•„ë³´" ê°™ì€ ì˜ë„ì  ë³€í˜•ì€ ë¯¸ì²˜ë¦¬ (ê¸°ëŠ¥ êµ¬í˜„ì— ì§‘ì¤‘)

**í–¥í›„ ê°œì„  ë°©í–¥**
- AI ê¸°ë°˜ í•„í„°ë§ ë„ì… ì‹œ ì´ ê²½í—˜ì´ ê¸°ë°˜ì´ ë  ê²ƒ

</details>

<details>
<summary><b>2ï¸âƒ£ Redis ì œì¬ ìºì‹± êµ¬í˜„</b></summary>

### RedisService.java - Hash êµ¬ì¡° í™œìš©
```java
@Service
@RequiredArgsConstructor
public class RedisService {
  private final RedisTemplate<String, Object> redisTemplate;
  private final MemberMapper memberMapper;

  // Redisì—ì„œ íšŒì› ì œì¬ ì •ë³´ ì¡°íšŒ
  public MemberDTO getMemberSanctionInfo(int memId) {
    String key = "member:" + memId;
    
    // Redis Hash ì „ì²´ ì¡°íšŒ
    Map<Object, Object> cachedData = redisTemplate.opsForHash().entries(key);
    
    if (!cachedData.isEmpty()) {
      // ìºì‹œ íˆíŠ¸ - Redisì—ì„œ ë°”ë¡œ ë°˜í™˜
      return convertToMemberDTO(cachedData);
    }
    
    // ìºì‹œ ë¯¸ìŠ¤ - DB ì¡°íšŒ í›„ Redisì— ìºì‹±
    MemberDTO memberDTO = memberMapper.getMemberStatusById(memId);
    if (memberDTO != null) {
      cacheMemberSanctionInfo(memId, memberDTO);
    }
    return memberDTO;
  }

  // ì œì¬ ì‹œ Redis ì¦‰ì‹œ ì—…ë°ì´íŠ¸
  public void updateMemberStatus(int memId, String newStatus, 
                                  LocalDateTime bannedUntil,
                                  String sanctionType, 
                                  String sanctionReason) {
    String key = "member:" + memId;
    
    Map<String, String> updates = new HashMap<>();
    updates.put("status", newStatus);
    updates.put("bannedUntil", bannedUntil != null ? bannedUntil.format(FORMATTER) : "");
    updates.put("sanctionType", sanctionType != null ? sanctionType : "");
    updates.put("sanctionReason", sanctionReason != null ? sanctionReason : "");
    
    // Hash í•„ë“œë³„ ì—…ë°ì´íŠ¸
    redisTemplate.opsForHash().putAll(key, updates);
    redisTemplate.expire(key, 24, TimeUnit.HOURS);
  }
}
```

**ì„¤ê³„ ê²°ì • ê³¼ì •**
1. **ì´ˆê¸° ì„¤ê³„**: `Map<String, String>` êµ¬ì¡°ë¡œ ì €ì¥
   - ë¬¸ì œ: member í…Œì´ë¸”ì˜ active, bannedë§Œ ì €ì¥ ê°€ëŠ¥
   - í•œê³„: 3íšŒ, 6íšŒ, 9íšŒ ê²½ê³ ì— ë”°ë¥¸ ë¶„ê¸° ì²˜ë¦¬ ë¶ˆê°€

2. **ê°œì„  ì„¤ê³„**: **Redis Hash êµ¬ì¡° ë„ì…**
   - `user:{id}` í‚¤ì— ì—¬ëŸ¬ í•„ë“œ ì €ì¥
   - í•„ë“œ: status, reason, banDate, warnCount, sanctionType
   - íš¨ê³¼: í•„ë“œ ë‹¨ìœ„ ì ‘ê·¼ìœ¼ë¡œ ìœ ì—°í•œ ë¶„ê¸° ì²˜ë¦¬ ê°€ëŠ¥

**ìºì‹± ì „ëµ**
- TTL 24ì‹œê°„ ì„¤ì •
- ì´ìœ :
  1. ì œì¬ ìƒíƒœ ë³€ê²½ ì‹œ `updateMemberStatus()`ê°€ ì¦‰ì‹œ í˜¸ì¶œë˜ì–´ Redis ê°±ì‹ 
  2. ì œì¬ ì •ë³´ëŠ” ë³´ì•ˆìƒ ë¯¼ê°í•˜ì§€ ì•ŠìŒ
  3. 24ì‹œê°„ ë™ì•ˆ DB ë¶€í•˜ ê°ì†Œ íš¨ê³¼ ê·¹ëŒ€í™”

</details>

<details>
<summary><b>3ï¸âƒ£ ë‹¨ê³„ì  ì œì¬ ë¡œì§ êµ¬í˜„</b></summary>

### ReportService.java - ê²½ê³  íšŸìˆ˜ì— ë”°ë¥¸ ì œì¬
```java
@Transactional(rollbackFor = Exception.class)
public void handleReport(ReportDTO reportDTO, int adminId) {
  // 1. ì‹ ê³  ìŠ¹ì¸ ì²˜ë¦¬
  reportMapper.handleReport(reportDTO);
  
  // 2. íšŒì› ê²½ê³  íšŸìˆ˜ ì¦ê°€
  memberMapper.addWarningCnt(targetMemId);
  
  // 3. ì½˜í…ì¸  í•„í„°ë§ (ë¸”ë¼ì¸ë“œ ì²˜ë¦¬)
  if (isPost) {
    postMapper.filterPost(targetContentId);
  } else {
    commentMapper.filterComment(targetContentId);
  }
  
  // 4. ê²½ê³  íšŸìˆ˜ ì¡°íšŒ í›„ ì œì¬ ì ìš©
  int warningCnt = memberMapper.getMemberStatusById(targetMemId).getWarningCnt();
  
  if (warningCnt >= 9) {
    // ì˜êµ¬ ì •ì§€
    bannedUntil = LocalDateTime.of(2099, 12, 31, 23, 59);
    sanctionType = "BAN_PERMANENT";
    sanctionReason = "ì‹ ê³  9íšŒ ëˆ„ì ìœ¼ë¡œ ì˜êµ¬ ì •ì§€";
    
    sanctionMapper.regSanction(sanctionDTO);
    memberMapper.banMember(bannedUntilStr, targetMemId);
    redisService.updateMemberStatus(targetMemId, "BANNED", bannedUntil, sanctionType, sanctionReason);
    
  } else if (warningCnt == 6) {
    // 3ë¶„ ì •ì§€
    bannedUntil = LocalDateTime.now().plusMinutes(3);
    sanctionType = "BAN_TEMP_2";
    sanctionReason = "ì‹ ê³  6íšŒ ëˆ„ì ìœ¼ë¡œ " + bannedUntil + "ê¹Œì§€ ì •ì§€";
    // ... (ì œì¬ ì²˜ë¦¬ ë™ì¼)
    
  } else if (warningCnt == 3) {
    // 1ë¶„ ì •ì§€
    bannedUntil = LocalDateTime.now().plusMinutes(1);
    sanctionType = "BAN_TEMP_1";
    sanctionReason = "ì‹ ê³  3íšŒ ëˆ„ì ìœ¼ë¡œ " + bannedUntil + "ê¹Œì§€ ì •ì§€";
    // ... (ì œì¬ ì²˜ë¦¬ ë™ì¼)
    
  } else {
    // ê²½ê³ ë§Œ (ì œì¬ ì—†ìŒ)
    log.info("ê²½ê³  {}íšŒ - ì œì¬ ì—†ìŒ (ì½˜í…ì¸  í•„í„°ë§ë§Œ)", warningCnt);
    // Redis ê²½ê³  íšŸìˆ˜ë§Œ ì—…ë°ì´íŠ¸
    redisService.cacheMemberSanctionInfo(targetMemId, updated);
  }
}
```

**íŠ¸ëœì­ì…˜ ê³ ë ¤ì‚¬í•­**
- ì›ë˜ëŠ” `sanctionService`ì— ì œì¬ ë¡œì§ì„ ë¶„ë¦¬í•˜ê³  ì‹¶ì—ˆìŒ
- í•˜ì§€ë§Œ `reportService`ì—ì„œ íŠ¸ëœì­ì…˜ì„ ìœ ì§€í•´ì•¼ í–ˆê¸° ë•Œë¬¸ì—
- í•µì‹¬ ê¸°ëŠ¥ì— ì§‘ì¤‘í•˜ê¸° ìœ„í•´ `reportService`ì—ì„œ ì²˜ë¦¬

</details>

<details>
<summary><b>4ï¸âƒ£ JWT ì¸ì¦ + ì œì¬ ìƒíƒœ í™•ì¸</b></summary>

### LoginFilter.java - ë¡œê·¸ì¸ ì‹œ ì œì¬ í™•ì¸
```java
@Override
protected void successfulAuthentication(HttpServletRequest request, 
                                         HttpServletResponse response,
                                         FilterChain chain, 
                                         Authentication authResult) {
  // í† í° ìƒì„±ì„ ìœ„í•œ ì •ë³´ ì¶”ì¶œ
  CustomUserDetails userDetails = (CustomUserDetails) authResult.getPrincipal();
  MemberDTO memberDTO = userDetails.getMemberDTO();
  int memId = memberDTO.getMemId();

  // Redisì—ì„œ ì œì¬ ìƒíƒœ í™•ì¸
  MemberDTO memberInfo = redisService.getMemberSanctionInfo(memId);
  if ("BANNED".equals(memberInfo.getMemStatus())) {
    SanctionDTO sanctionDTO = memberInfo.getSanctionDTO();
    String sanctionReason = sanctionDTO.getSanctionReason();
    
    response.setStatus(HttpServletResponse.SC_FORBIDDEN);
    response.setContentType("application/json;charset=UTF-8");
    
    String errorMessage = String.format(
      "{\"error\":\"ê³„ì •ì´ ì •ì§€ë˜ì—ˆìŠµë‹ˆë‹¤\",\"reason\":\"%s\"}",
      sanctionReason
    );
    response.getWriter().write(errorMessage);
    return;  // ë¡œê·¸ì¸ ì°¨ë‹¨
  }

  // ì œì¬ê°€ ì—†ìœ¼ë©´ JWT í† í° ë°œê¸‰
  String accessToken = jwtUtil.createJwt(username, role, memId, (1000 * 60 * 20));
  response.setHeader("Authorization", "Bearer " + accessToken);
}
```

### JwtConfirmFilter.java - ìš”ì²­ë§ˆë‹¤ ì œì¬ í™•ì¸
```java
@Override
protected void doFilterInternal(HttpServletRequest request, 
                                 HttpServletResponse response,
                                 FilterChain filterChain) {
  // 1. í—¤ë”ì—ì„œ í† í° ì¶”ì¶œ
  String token = null;
  String authorization = request.getHeader("Authorization");
  if (authorization != null && authorization.startsWith("Bearer ")) {
    token = authorization.split(" ")[1];
  }
  
  // 2. SSE ìš”ì²­ì¸ ê²½ìš° URLì—ì„œ í† í° ì¶”ì¶œ
  if (token == null && request.getRequestURL().toString().contains("/admin/reports/stream")) {
    String paramToken = request.getParameter("token");
    if (paramToken != null && paramToken.startsWith("Bearer ")) {
      token = paramToken.substring(7);
    }
  }
  
  // 3. í† í° ìœ íš¨ì„± ê²€ì¦
  if (token != null && !jwtUtil.isExpired(token)) {
    int memId = jwtUtil.getMemIdFromToken(token);
    
    // 4. Redisì—ì„œ ì œì¬ ìƒíƒœ í™•ì¸
    MemberDTO memberInfo = redisService.getMemberSanctionInfo(memId);
    if ("BANNED".equals(memberInfo.getMemStatus())) {
      // ì œì¬ëœ ì‚¬ìš©ì ì°¨ë‹¨
      response.setStatus(HttpServletResponse.SC_FORBIDDEN);
      response.setContentType("application/json;charset=UTF-8");
      response.getWriter().write("{\"error\":\"ê³„ì •ì´ ì •ì§€ë˜ì—ˆìŠµë‹ˆë‹¤\"}");
      return;
    }
    
    // 5. ì¸ì¦ ì •ë³´ SecurityContextì— ì €ì¥
    SecurityContextHolder.getContext().setAuthentication(authToken);
  }
  
  filterChain.doFilter(request, response);
}
```

**ì œì¬ í™•ì¸ íë¦„**
1. **ë¡œê·¸ì¸ ì‹œ**:
   - `loginFilter`ì—ì„œ `authenticationManager`ë¡œ ì‚¬ìš©ì ì¸ì¦
   - ê²€ì¦ëœ ì‚¬ìš©ì ì •ë³´ë¡œ Redisì—ì„œ ì œì¬ ìƒíƒœ í™•ì¸
   - ì œì¬ ì¤‘ì´ë©´ ë¡œê·¸ì¸ ì°¨ë‹¨ + ì‚¬ìœ  í¬í•¨ ì‘ë‹µ

2. **ìš”ì²­ë§ˆë‹¤**:
   - `jwtConfirmFilter`ì—ì„œ í† í° ê²€ì¦
   - Redisì—ì„œ ì œì¬ ìƒíƒœ í™•ì¸
   - ì œì¬ ì¤‘ì´ë©´ ìš”ì²­ ì°¨ë‹¨

</details>

<details>
<summary><b>5ï¸âƒ£ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ í†µí•œ ì œì¬ ìë™ í•´ì œ</b></summary>

### SanctionScheduler.java
```java
@Component
@RequiredArgsConstructor
public class SanctionScheduler {
  private final MemberMapper memberMapper;
  private final RedisTemplate<String, Object> redisTemplate;

  // ë§¤ë¶„ë§ˆë‹¤ ë§Œë£Œëœ ì •ì§€ í•´ì œ
  @Scheduled(cron = "0 * * * * *")  // ë§¤ë¶„ 0ì´ˆ
  public void releaseExpiredBans() {
    LocalDateTime now = LocalDateTime.now();
    
    // 1. DBì—ì„œ í•´ì œ ëŒ€ìƒ ì¡°íšŒ
    List<MemberDTO> expiredMembers = memberMapper.getExpiredBannedMembers(now);
    
    for (MemberDTO member : expiredMembers) {
      int memId = member.getMemId();
      
      // 2. DB ìƒíƒœ ì—…ë°ì´íŠ¸
      memberMapper.updateMemberStatus(memId, "ACTIVE");
      
      // 3. Redis ë™ê¸°í™” (í‚¤ê°€ ìˆìœ¼ë©´)
      String redisKey = "member:" + memId;
      if (redisTemplate.hasKey(redisKey)) {
        Map<String, String> updates = Map.of(
          "status", "ACTIVE",
          "bannedUntil", ""
        );
        redisTemplate.opsForHash().putAll(redisKey, updates);
      }
    }
  }
}
```

**ì„¤ê³„ ê²°ì •**
- ì‹¤ì‹œê°„ ì²˜ë¦¬ ëŒ€ì‹  ìŠ¤ì¼€ì¤„ëŸ¬ë¡œ í•´ê²°
- ì´ìœ :
  1. ì œì¬ í•´ì œëŠ” ì´ˆ ë‹¨ìœ„ ì •í™•ì„±ì´ ë¶ˆí•„ìš”
  2. 1ë¶„ ë‹¨ìœ„ í™•ì¸ìœ¼ë¡œë„ ì¶©ë¶„í•œ UX
  3. ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ ë„ì… ì—†ì´ ë°ì´í„° ì¼ê´€ì„± ìœ ì§€ ê°€ëŠ¥

</details>

<details>
<summary><b>6ï¸âƒ£ SSE ì‹¤ì‹œê°„ ì•Œë¦¼ êµ¬í˜„</b></summary>

### SseEmitterService.java
```java
@Service
public class SseEmitterService {
  // ê´€ë¦¬ìë“¤ì˜ SSE ì—°ê²°ì„ ì €ì¥í•  Map
  private final Map<String, SseEmitter> emitters = new ConcurrentHashMap<>();

  // ê´€ë¦¬ì SSE ì—°ê²° ìƒì„±
  public SseEmitter createSseEmitter(String adminId) {
    SseEmitter emitter = new SseEmitter(180000L);  // 3ë¶„ íƒ€ì„ì•„ì›ƒ
    emitters.put(adminId, emitter);
    
    // ì—°ê²° ì¢…ë£Œ/íƒ€ì„ì•„ì›ƒ/ì—ëŸ¬ ì‹œ ì œê±°
    emitter.onCompletion(() -> emitters.remove(adminId));
    emitter.onTimeout(() -> emitters.remove(adminId));
    emitter.onError((e) -> emitters.remove(adminId));
    
    // ì—°ê²° í™•ì¸ìš© ë”ë¯¸ ë°ì´í„° ì „ì†¡
    try {
      emitter.send(SseEmitter.event()
        .name("connect")
        .data("SSE ì—°ê²° ì„±ê³µ"));
    } catch (IOException e) {
      emitters.remove(adminId);
    }
    
    return emitter;
  }

  // ëª¨ë“  ê´€ë¦¬ìì—ê²Œ ì‹ ê³  ì•Œë¦¼ ì „ì†¡
  public void sendToAll(Object data) {
    emitters.forEach((adminId, emitter) -> {
      try {
        emitter.send(SseEmitter.event()
          .name("newReport")
          .data(data));
      } catch (IOException e) {
        emitters.remove(adminId);
      }
    });
  }
}
```

### AdminReportController.java - SSE ì—”ë“œí¬ì¸íŠ¸
```java
@GetMapping("/stream")
@PreAuthorize("hasRole('ADMIN')")
public SseEmitter streamReports(@RequestParam("token") String token) {
  // URL íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ í† í°ì—ì„œ adminId ì¶”ì¶œ
  String adminId = jwtUtil.getMemIdFromToken(token.substring(7)).toString();
  return sseEmitterService.createSseEmitter(adminId);
}
```

**ê¸°ìˆ  ì„ íƒì˜ íŒë‹¨ë ¥**
- âŒ WebSocket ê³ ë ¤ â†’ ì–‘ë°©í–¥ í†µì‹  ë¶ˆí•„ìš”
- âœ… SSE ì„ íƒ â†’ ê´€ë¦¬ìë§Œ ë‹¨ë°©í–¥ ì•Œë¦¼ì„ ë°›ìœ¼ë©´ ë˜ëŠ” êµ¬ì¡°
- ê¸°ìˆ ì„ ë¬´ì‘ì • ì“°ëŠ” ê²Œ ì•„ë‹ˆë¼, **ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” ìµœì ì˜ ê¸°ìˆ  ì„ íƒ**

</details>

<details>
<summary><b>7ï¸âƒ£ Enumìœ¼ë¡œ ì½”ë“œ í’ˆì§ˆ í–¥ìƒ</b></summary>

### ReportStatus.java - ì‹ ê³  ìƒíƒœ Enum
```java
public enum ReportStatus {
  PENDING,    // ëŒ€ê¸°
  APPROVED,   // ìŠ¹ì¸
  REJECTED;   // ê±°ì ˆ

  public static ReportStatus from(String value) {
    if (value == null || value.trim().isEmpty())
      throw new IllegalArgumentException("ì‹ ê³  ìƒíƒœê°’ì€ null ë˜ëŠ” ë¹ˆë¬¸ìì—´ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    
    try {
      return ReportStatus.valueOf(value.trim().toUpperCase());
    } catch (Exception e) {
      throw new IllegalArgumentException("ì§€ì›í•˜ì§€ ì•ŠëŠ” ì‹ ê³  ìƒíƒœê°’ì…ë‹ˆë‹¤: " + value);
    }
  }
}
```

### ReportTargetType.java - ì‹ ê³  ëŒ€ìƒ Enum
```java
public enum ReportTargetType {
  POST,      // ê²Œì‹œê¸€
  COMMENT;   // ëŒ“ê¸€

  public static ReportTargetType from(String value) {
    if (value == null || value.trim().isEmpty())
      throw new IllegalArgumentException("ì‹ ê³  ëŒ€ìƒ ìœ í˜•ì€ null ë˜ëŠ” ë¹ˆë¬¸ìì—´ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    
    try {
      return ReportTargetType.valueOf(value.trim().toUpperCase());
    } catch (Exception e) {
      throw new IllegalArgumentException("ì§€ì›í•˜ì§€ ì•ŠëŠ” ì‹ ê³  ëŒ€ìƒ ìœ í˜•ì…ë‹ˆë‹¤: " + value);
    }
  }
}

**Enum ì‚¬ìš©ì˜ íš¨ê³¼**
- âœ… íƒ€ì… ì•ˆì •ì„± ë³´ì¥
- âœ… ì˜ëª»ëœ ê°’ ì…ë ¥ ë°©ì§€
- âœ… ì½”ë“œ ê°€ë…ì„± í–¥ìƒ
- âœ… IDE ìë™ì™„ì„± ì§€ì›

</details>

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### ERD
> ğŸ“¸ **ì´ë¯¸ì§€ ìœ„ì¹˜**: `images/erd.png`

### ì£¼ìš” í…Œì´ë¸” êµ¬ì¡°

#### 1. member (íšŒì›)
```sql
CREATE TABLE member (
  mem_id INT PRIMARY KEY AUTO_INCREMENT,
  mem_email VARCHAR(100) NOT NULL UNIQUE,
  mem_pw VARCHAR(255) NOT NULL,
  mem_nickname VARCHAR(50) NOT NULL,
  mem_role ENUM('USER', 'ADMIN') DEFAULT 'USER',
  mem_status ENUM('ACTIVE', 'BANNED') DEFAULT 'ACTIVE',
  warning_cnt INT DEFAULT 0,
  banned_until DATETIME NULL,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

#### 2. post (ê²Œì‹œê¸€)
```sql
CREATE TABLE post (
  post_id INT PRIMARY KEY AUTO_INCREMENT,
  mem_id INT NOT NULL,
  post_title VARCHAR(200) NOT NULL,
  post_content TEXT NOT NULL,
  is_filtered BOOLEAN DEFAULT FALSE,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (mem_id) REFERENCES member(mem_id)
);
```

#### 3. comment (ëŒ“ê¸€)
```sql
CREATE TABLE comment (
  cmt_id INT PRIMARY KEY AUTO_INCREMENT,
  post_id INT NOT NULL,
  mem_id INT NOT NULL,
  cmt_content TEXT NOT NULL,
  is_filtered BOOLEAN DEFAULT FALSE,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (post_id) REFERENCES post(post_id),
  FOREIGN KEY (mem_id) REFERENCES member(mem_id)
);
```

#### 4. report (ì‹ ê³ )
```sql
CREATE TABLE report (
  report_id INT PRIMARY KEY AUTO_INCREMENT,
  mem_id INT NOT NULL,
  target_type ENUM('POST', 'COMMENT') NOT NULL,
  target_id INT NOT NULL,
  report_reason VARCHAR(255) NOT NULL,
  report_status ENUM('PENDING', 'APPROVED', 'REJECTED') DEFAULT 'PENDING',
  report_date DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (mem_id) REFERENCES member(mem_id)
);
```

#### 5. sanction (ì œì¬)
```sql
CREATE TABLE sanction (
  sanction_id INT PRIMARY KEY AUTO_INCREMENT,
  mem_id INT NOT NULL,
  admin_id INT NOT NULL,
  sanction_type ENUM('BAN_TEMP_1', 'BAN_TEMP_2', 'BAN_PERMANENT') NOT NULL,
  sanction_reason VARCHAR(255) NOT NULL,
  start_date DATETIME DEFAULT CURRENT_TIMESTAMP,
  end_date DATETIME NULL,
  FOREIGN KEY (mem_id) REFERENCES member(mem_id),
  FOREIGN KEY (admin_id) REFERENCES member(mem_id)
);
```

### Redis ë°ì´í„° êµ¬ì¡°

Key: member:{memId}
Type: Hash
Fields:

status: "ACTIVE" | "BANNED"
warningCnt: "3"
bannedUntil: "2025-11-14T15:30:00"
sanctionType: "BAN_TEMP_1"
sanctionReason: "ì‹ ê³  3íšŒ ëˆ„ì ìœ¼ë¡œ 2025-11-14 15:30:00ê¹Œì§€ ì •ì§€"
TTL: 24ì‹œê°„

---

## ğŸ”§ í”„ë¡œì íŠ¸ êµ¬ì¡°

src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ java/com/safespace/content_filter_backend/
â”‚   â”‚   â”œâ”€â”€ auth/                           # ì¸ì¦ ê´€ë ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ filter/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginFilter.java       # ë¡œê·¸ì¸ í•„í„°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ JwtConfirmFilter.java  # JWT ê²€ì¦ í•„í„°
â”‚   â”‚   â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ UserDetailServiceImpl.java
â”‚   â”‚   â”‚   â””â”€â”€ util/
â”‚   â”‚   â”‚       â””â”€â”€ JwtUtil.java           # JWT ìƒì„±/ê²€ì¦
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ SecurityConfig.java        # Spring Security ì„¤ì •
â”‚   â”‚   â”‚   â””â”€â”€ RedisConfig.java           # Redis ì„¤ì •
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”‚   â”œâ”€â”€ admin/                     # ê´€ë¦¬ì ê¸°ëŠ¥
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AdminReportController.java
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ service/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ SseEmitterService.java  # SSE ì‹¤ì‹œê°„ ì•Œë¦¼
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ member/                    # íšŒì› ê´€ë¦¬
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dto/MemberDTO.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mapper/MemberMapper.java
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ service/MemberService.java
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ post/                      # ê²Œì‹œê¸€
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ controller/PostController.java
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ service/PostService.java
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ comment/                   # ëŒ“ê¸€
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ report/                    # ì‹ ê³ 
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ controller/ReportController.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ service/ReportService.java
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ model/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ ReportStatus.java      # Enum
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ReportTargetType.java  # Enum
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ sanction/                  # ì œì¬
â”‚   â”‚   â”‚       â”œâ”€â”€ scheduler/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ SanctionScheduler.java  # ì œì¬ í•´ì œ ìŠ¤ì¼€ì¤„ëŸ¬
â”‚   â”‚   â”‚       â””â”€â”€ service/SanctionService.java
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ infra/                         # ì¸í”„ë¼ ê³„ì¸µ
â”‚   â”‚       â”œâ”€â”€ filtering/
â”‚   â”‚       â”‚   â””â”€â”€ ProfanityFilter.java   # ìš•ì„¤ í•„í„°ë§
â”‚   â”‚       â””â”€â”€ redis/
â”‚   â”‚           â””â”€â”€ RedisService.java      # Redis ìºì‹±
â”‚   â”‚
â”‚   â””â”€â”€ resources/
â”‚       â”œâ”€â”€ mapper/                        # MyBatis XML
â”‚       â”‚   â”œâ”€â”€ member-mapper.xml
â”‚       â”‚   â”œâ”€â”€ post-mapper.xml
â”‚       â”‚   â”œâ”€â”€ report-mapper.xml
â”‚       â”‚   â””â”€â”€ sanction-mapper.xml
â”‚       â””â”€â”€ application.properties         # ì„¤ì • íŒŒì¼

---

## ğŸ¬ ì£¼ìš” í™”ë©´

### 1ï¸âƒ£ ì‹ ê³  ìë™ ìƒì„± í”Œë¡œìš°
> ğŸ“¸ **ì´ë¯¸ì§€/GIF ìœ„ì¹˜**: `images/report_flow.gif`

**ë™ì‘ ê³¼ì •**
1. ì‚¬ìš©ìê°€ ìš•ì„¤ì´ í¬í•¨ëœ ê²Œì‹œê¸€/ëŒ“ê¸€ ì‘ì„±
2. `ProfanityFilter`ê°€ ìš•ì„¤ ê°ì§€
3. ì‹ ê³  ê°ì²´ ìë™ ìƒì„± ë° DB ì €ì¥
4. SSEë¥¼ í†µí•´ ê´€ë¦¬ìì—ê²Œ ì‹¤ì‹œê°„ ì•Œë¦¼ ì „ì†¡

---

### 2ï¸âƒ£ ê´€ë¦¬ì ì‹¤ì‹œê°„ ì•Œë¦¼
> ğŸ“¸ **ì´ë¯¸ì§€/GIF ìœ„ì¹˜**: `images/admin_notification.gif`

**ì£¼ìš” ê¸°ëŠ¥**
- ğŸ’¬ ì‹¤ì‹œê°„ ì‹ ê³  ì•Œë¦¼ ìˆ˜ì‹ 
- ğŸ“‹ ì‹ ê³  ëª©ë¡ ì¡°íšŒ
- âœ… ì‹ ê³  ìŠ¹ì¸/ê±°ì ˆ ì²˜ë¦¬

---

### 3ï¸âƒ£ ë‹¨ê³„ì  ì œì¬ ì ìš©
> ğŸ“¸ **ì´ë¯¸ì§€/GIF ìœ„ì¹˜**: `images/sanction_flow.gif`

**ì œì¬ íë¦„**
1. ê´€ë¦¬ìê°€ ì‹ ê³  ìŠ¹ì¸
2. ê²½ê³  íšŸìˆ˜ ì¦ê°€
3. ê²½ê³  íšŸìˆ˜ì— ë”°ë¼ ìë™ ì œì¬
4. Redisì— ì œì¬ ìƒíƒœ ì¦‰ì‹œ ë°˜ì˜
5. ì œì¬ ì¤‘ì¸ ì‚¬ìš©ì ë¡œê·¸ì¸ ì°¨ë‹¨

---

### 4ï¸âƒ£ ì œì¬ ìƒíƒœ í™•ì¸
> ğŸ“¸ **ì´ë¯¸ì§€/GIF ìœ„ì¹˜**: `images/ban_check.gif`

**ë¡œê·¸ì¸ ì°¨ë‹¨ í™”ë©´**
- ì œì¬ ì‚¬ìœ  í‘œì‹œ
- ì œì¬ ê¸°ê°„ ì•ˆë‚´

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. ì‚¬ì „ ìš”êµ¬ì‚¬í•­
```bash
- Java 17
- MariaDB 10.x
- Redis 7.x
- Gradle 8.x
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
```sql
-- MariaDB ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
CREATE DATABASE safespace CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- ì‚¬ìš©ì ìƒì„± ë° ê¶Œí•œ ë¶€ì—¬
CREATE USER 'safespace'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON safespace.* TO 'safespace'@'localhost';
FLUSH PRIVILEGES;
```

### 3. Redis ì‹¤í–‰
```bash
# Dockerë¡œ Redis ì‹¤í–‰
docker run -d -p 6379:6379 redis:7-alpine

# ë˜ëŠ” ë¡œì»¬ ì„¤ì¹˜ í›„
redis-server
```

### 4. application.properties ì„¤ì •
```properties
# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
spring.datasource.url=jdbc:mariadb://localhost:3306/safespace
spring.datasource.username=safespace
spring.datasource.password=your_password
spring.datasource.driver-class-name=org.mariadb.jdbc.Driver

# MyBatis ì„¤ì •
mybatis.mapper-locations=classpath:mapper/*.xml
mybatis.type-aliases-package=com.safespace.content_filter_backend.domain

# Redis ì„¤ì •
spring.data.redis.host=localhost
spring.data.redis.port=6379

# JWT ì„¤ì •
jwt.secret=your_secret_key_here_minimum_256_bits
jwt.expiration=1200000

# ë¡œê·¸ ì„¤ì •
logging.level.com.safespace=DEBUG
```

### 5. í”„ë¡œì íŠ¸ ì‹¤í–‰
```bash
# Gradleë¡œ ë¹Œë“œ ë° ì‹¤í–‰
./gradlew clean build
./gradlew bootRun

# ë˜ëŠ” JAR íŒŒì¼ ì‹¤í–‰
java -jar build/libs/content-filter-backend-0.0.1-SNAPSHOT.jar
```

### 6. ì ‘ì† í™•ì¸
```bash
# ì„œë²„ ì‹¤í–‰ í™•ì¸
curl http://localhost:8080/actuator/health

# ê´€ë¦¬ì SSE ì—°ê²° í…ŒìŠ¤íŠ¸ (í† í° í•„ìš”)
curl -N http://localhost:8080/admin/reports/stream?token=Bearer_YOUR_TOKEN
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ìš•ì„¤ í•„í„°ë§ í…ŒìŠ¤íŠ¸
```bash
# ìš•ì„¤ í¬í•¨ ê²Œì‹œê¸€ ì‘ì„±
POST /posts
Content-Type: application/json
Authorization: Bearer {token}

{
  "postTitle": "í…ŒìŠ¤íŠ¸",
  "postContent": "ë°”ë³´ ê°™ì€ ë‚´ìš©"
}

# ì˜ˆìƒ ê²°ê³¼: 400 Bad Request + ìë™ ì‹ ê³  ìƒì„±
```

### 2. ì‹ ê³  ì²˜ë¦¬ ë° ì œì¬ í…ŒìŠ¤íŠ¸
```bash
# 1ë‹¨ê³„: 3íšŒ ê²½ê³  (1ë¶„ ì •ì§€)
POST /admin/reports/handle
{
  "reportId": 1,
  "reportStatus": "APPROVED"
}

# 2ë‹¨ê³„: 6íšŒ ê²½ê³  (3ë¶„ ì •ì§€)
POST /admin/reports/handle
{
  "reportId": 2,
  "reportStatus": "APPROVED"
}

# 3ë‹¨ê³„: 9íšŒ ê²½ê³  (ì˜êµ¬ ì •ì§€)
POST /admin/reports/handle
{
  "reportId": 3,
  "reportStatus": "APPROVED"
}
```

### 3. Redis ìºì‹± í™•ì¸
```bash
# Redis CLIë¡œ ì œì¬ ì •ë³´ í™•ì¸
redis-cli
> HGETALL member:1
1) "status"
2) "BANNED"
3) "warningCnt"
4) "3"
5) "bannedUntil"
6) "2025-11-14T15:30:00"
7) "sanctionType"
8) "BAN_TEMP_1"
9) "sanctionReason"
10) "ì‹ ê³  3íšŒ ëˆ„ì ìœ¼ë¡œ 2025-11-14 15:30:00ê¹Œì§€ ì •ì§€"
```

---

## ğŸ’¬ ê¸°ìˆ ì  ì˜ì‚¬ê²°ì • ë° íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1ï¸âƒ£ JWT ì¸ì¦ êµ¬í˜„ ì´ìœ 

**ì„ íƒ ë°°ê²½**
> "ì¸ì¦ê³¼ ê¶Œí•œ ê´€ë¦¬ë¥¼ ìœ„í•´ Spring Securityì™€ JWTë¥¼ ë„ì…í–ˆìŠµë‹ˆë‹¤.  
> JWTëŠ” stateless ì¸ì¦ ë°©ì‹ìœ¼ë¡œ, ë¡œê·¸ì¸ ìƒíƒœë¥¼ ì„œë²„ì— ì €ì¥í•˜ì§€ ì•Šì•„ë„ ë˜ë©°  
> ì„œë²„ í™•ì¥ì„±ê³¼ API ì¤‘ì‹¬ êµ¬ì¡°ì— ì í•©í•˜ë‹¤ëŠ” ì ì„ ì§ì ‘ êµ¬í˜„í•˜ë©° ì²´ê°í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤."

**êµ¬í˜„ ë‚´ìš©**
- Spring Security + JWT ê¸°ë°˜ ì¸ì¦
- Access Token 20ë¶„ ìœ íš¨ê¸°ê°„
- ì œì¬ ìƒíƒœì™€ JWT ì—°ë™

---

### 2ï¸âƒ£ Redis ì„¤ê³„ ê³¼ì •

**ë¬¸ì œ ìƒí™©**
- ì´ˆê¸°: `Map<String, String>` êµ¬ì¡°ë¡œ ì„¤ê³„
- í•œê³„: member í…Œì´ë¸”ì˜ active, banned ìƒíƒœë§Œ ì €ì¥ ê°€ëŠ¥
- ê²°ê³¼: 3íšŒ, 6íšŒ, 9íšŒ ê²½ê³ ì— ë”°ë¥¸ ë¶„ê¸° ì²˜ë¦¬ ë¶ˆê°€

**í•´ê²° ë°©ë²•**
- Redis **Hash êµ¬ì¡°** ë„ì…
- `user:{id}` í‚¤ì— ì—¬ëŸ¬ í•„ë“œ ì €ì¥
- í•„ë“œ: status, reason, banDate, warnCount, sanctionType
- íš¨ê³¼: í•„ë“œ ë‹¨ìœ„ ì ‘ê·¼ìœ¼ë¡œ ìœ ì—°í•œ ë¶„ê¸° ì²˜ë¦¬ ê°€ëŠ¥

**ì„¤ê³„ ì›ì¹™**
> "ì œì¬ ë¡œì§ì€ ë§¤ ìš”ì²­ë§ˆë‹¤ í™•ì¸ì´ í•„ìš”í•˜ì§€ë§Œ ìƒíƒœ ë³€í™”ëŠ” ë“œë¬¼ê¸° ë•Œë¬¸ì—,  
> Redis ìºì‹± êµ¬ì¡°ì— ê°€ì¥ ì í•©í•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤."

---

### 3ï¸âƒ£ SSE ì„ íƒ ê³¼ì •

**ê¸°ìˆ  ë¹„êµ**
| ê¸°ìˆ  | ì¥ì  | ë‹¨ì  | ì í•©ì„± |
|------|------|------|--------|
| **WebSocket** | ì–‘ë°©í–¥ í†µì‹  | êµ¬í˜„ ë³µì¡, ë¶ˆí•„ìš”í•œ ê¸°ëŠ¥ | âŒ ì˜¤ë²„ìŠ¤í™ |
| **SSE** | HTTP ê¸°ë°˜, ë‹¨ë°©í–¥ | ë¸Œë¼ìš°ì € í˜¸í™˜ì„± | âœ… ìµœì  |
| **Polling** | ê°„ë‹¨ | ì„œë²„ ë¶€í•˜ | âŒ ë¹„íš¨ìœ¨ |

**ì„ íƒ ì´ìœ **
> "ì²˜ìŒì—” WebSocketì„ ê³ ë ¤í–ˆì§€ë§Œ,  
> ê´€ë¦¬ìë§Œ ë‹¨ë°©í–¥ ì•Œë¦¼ì„ ë°›ìœ¼ë©´ ë˜ëŠ” êµ¬ì¡°ë¼ SSEê°€ ë” ì í•©í•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤.  
> ê¸°ìˆ ì„ ë¬´ì‘ì • ì“°ëŠ” ê²Œ ì•„ë‹ˆë¼, **ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” ìµœì ì˜ ê¸°ìˆ ì„ ì„ íƒ**í•œ ê²½í—˜ì…ë‹ˆë‹¤."

**SSE ë³´ì•ˆ ë¬¸ì œ í•´ê²°**
- ë¬¸ì œ: SSEëŠ” Headerì— í† í°ì„ ë‹´ì„ ìˆ˜ ì—†ì–´ Spring Security ì¸ì¦ ì‹¤íŒ¨
- í•´ê²°:
  1. `/admin/reports/stream` ê²½ë¡œì— `.permitAll()` ì„¤ì •
  2. URL íŒŒë¼ë¯¸í„°ë¡œ í† í° ì „ë‹¬
  3. `JwtConfirmFilter`ì—ì„œ URL íŒŒë¼ë¯¸í„° í† í° ì¶”ì¶œ ë° ê²€ì¦
  4. `@PreAuthorize("hasRole('ADMIN')")`ë¡œ ê¶Œí•œ ë³´ì¥

---

### 4ï¸âƒ£ íŠ¸ëœì­ì…˜ ì„¤ê³„ ê³ ë¯¼

**ë¬¸ì œ ìƒí™©**
- ì›ë˜ëŠ” `sanctionService`ì— ì œì¬ ë¡œì§ì„ ë¶„ë¦¬í•˜ê³  ì‹¶ì—ˆìŒ
- í•˜ì§€ë§Œ `reportService`ì—ì„œ íŠ¸ëœì­ì…˜ì„ ìœ ì§€í•´ì•¼ í–ˆê¸° ë•Œë¬¸ì—

**í•´ê²°**
- í•µì‹¬ ê¸°ëŠ¥ì— ì§‘ì¤‘í•˜ê¸° ìœ„í•´ `reportService`ì—ì„œ ì²˜ë¦¬
- í–¥í›„ ë¦¬íŒ©í† ë§ ì‹œ ì„œë¹„ìŠ¤ ë¶„ë¦¬ ê³ ë ¤

---

### 5ï¸âƒ£ ìŠ¤ì¼€ì¤„ëŸ¬ vs ì‹¤ì‹œê°„ ì²˜ë¦¬

**ì„¤ê³„ ê²°ì •**
- ì œì¬ í•´ì œëŠ” **ìŠ¤ì¼€ì¤„ëŸ¬**ë¡œ ì²˜ë¦¬ (ë§¤ë¶„ ì‹¤í–‰)
- ì‹¤ì‹œê°„ ì²˜ë¦¬ ëŒ€ì‹  1ë¶„ ë‹¨ìœ„ í™•ì¸

**ì„ íƒ ì´ìœ **
1. ì œì¬ í•´ì œëŠ” ì´ˆ ë‹¨ìœ„ ì •í™•ì„±ì´ ë¶ˆí•„ìš”
2. 1ë¶„ ë‹¨ìœ„ í™•ì¸ìœ¼ë¡œë„ ì¶©ë¶„í•œ UX
3. ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ ë„ì… ì—†ì´ ë°ì´í„° ì¼ê´€ì„± ìœ ì§€ ê°€ëŠ¥

---

## ğŸ“ ë°°ìš´ ì  ë° ì„±ì¥

### ê¸°ìˆ ì  ì„±ì¥
1. **Redis Hash êµ¬ì¡° ì´í•´**
   - ë‹¨ìˆœ Key-Valueë¥¼ ë„˜ì–´ ë³µì¡í•œ ë°ì´í„° êµ¬ì¡° ì„¤ê³„
   - ìºì‹± ì „ëµê³¼ TTL ê´€ë¦¬ ê²½í—˜

2. **Spring Security ì‹¬í™”**
   - Filter Chain ë™ì‘ ì›ë¦¬ ì´í•´
   - JWTì™€ ì œì¬ ì‹œìŠ¤í…œ í†µí•© ê²½í—˜

3. **SSE ì‹¤ì‹œê°„ í†µì‹ **
   - WebSocketê³¼ì˜ ì°¨ì´ì  ì´í•´
   - ë³´ì•ˆ ë¬¸ì œ í•´ê²° ê²½í—˜

4. **íŠ¸ëœì­ì…˜ ê´€ë¦¬**
   - ì„œë¹„ìŠ¤ ê°„ íŠ¸ëœì­ì…˜ ì „íŒŒ ì´í•´
   - ì‹¤ë¬´ì  íƒ€í˜‘ì  ì°¾ê¸°

### ì•„í‚¤í…ì²˜ ì„¤ê³„ ëŠ¥ë ¥
1. **ê¸°ìˆ  ì„ íƒ íŒë‹¨ë ¥**
   - ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” ìµœì ì˜ ê¸°ìˆ  ì„ íƒ
   - ì˜¤ë²„ ì—”ì§€ë‹ˆì–´ë§ ì§€ì–‘

2. **ì„±ëŠ¥ ìµœì í™”**
   - DB ë¶€í•˜ë¥¼ ì¤„ì´ê¸° ìœ„í•œ Redis ìºì‹±
   - ìºì‹œ íˆíŠ¸ìœ¨ ê³ ë ¤í•œ ì„¤ê³„

3. **í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°**
   - Enumì„ í™œìš©í•œ íƒ€ì… ì•ˆì •ì„±
   - ë ˆì´ì–´ë“œ ì•„í‚¤í…ì²˜ ì ìš©

---

## ğŸ”® í–¥í›„ ê°œì„  ë°©í–¥

### 1. AI ê¸°ë°˜ í•„í„°ë§ ë„ì…
- í˜„ì¬: ë‹¨ìˆœ í‚¤ì›Œë“œ ë§¤ì¹­
- ê°œì„ : ìì—°ì–´ ì²˜ë¦¬ ëª¨ë¸ í™œìš©
- íš¨ê³¼: "ë°”1ë³´", "ë°”ì•„ì•„ë³´" ê°™ì€ ë³€í˜• ê°ì§€ ê°€ëŠ¥

### 2. Refresh Token ë„ì…
- í˜„ì¬: Access Tokenë§Œ ì‚¬ìš© (20ë¶„)
- ê°œì„ : Refresh Token ì¶”ê°€
- íš¨ê³¼: ì‚¬ìš©ì í¸ì˜ì„± í–¥ìƒ

### 3. ì œì¬ ì´ë ¥ ëŒ€ì‹œë³´ë“œ
- ê´€ë¦¬ììš© í†µê³„ í˜ì´ì§€
- ì œì¬ ì¶”ì´ ì‹œê°í™”
- ìš•ì„¤ ë¹ˆë„ ë¶„ì„

### 4. ì‚¬ìš©ì ì´ì˜ì œê¸° ì‹œìŠ¤í…œ
- ì œì¬ì— ëŒ€í•œ ì´ì˜ì œê¸° ê¸°ëŠ¥
- ê´€ë¦¬ì ì¬ê²€í†  í”„ë¡œì„¸ìŠ¤

---

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” ê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤ ëª©ì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ‘¨â€ğŸ’» ê°œë°œì

**ì´ë¦„**: [Your Name]  
**ì´ë©”ì¼**: [Your Email]  
**GitHub**: [Your GitHub]  
**ë¸”ë¡œê·¸**: [Your Blog]

---

## ğŸ“ ë¬¸ì˜

í”„ë¡œì íŠ¸ì— ëŒ€í•œ ë¬¸ì˜ì‚¬í•­ì´ë‚˜ í”¼ë“œë°±ì€ ì–¸ì œë“  í™˜ì˜í•©ë‹ˆë‹¤!

- ğŸ“§ Email: [your.email@example.com]
- ğŸ’¬ GitHub Issues: [Repository Issues Link]

---

<div align="center">

**"ê¸°ìˆ ì„ í†µí•´ ë” ë‚˜ì€ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ í™˜ê²½ì„ ë§Œë“¤ë‹¤"**

Made with â¤ï¸ by [Your Name]

</div>
